<!DOCTYPE html>
        <html lang="fr">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Diagramme de Menaces - Threat Model</title>
            <style>
                body {
                    margin: 0;
                    padding: 0;
                    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                    background-color: #f5f5f5;
                    overflow: hidden;
                    user-select: none;
                }
                .diagram-container {
                    position: relative;
                    width: 100vw;
                    height: 100vh;
                    display: flex;
                    justify-content: center;
                    align-items: center;
                }
                .svg-container {
                    position: absolute;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    background: white;
                    padding: 20px;
                    box-sizing: border-box;
                }
                .svg-container svg {
                    max-width: 100%;
                    max-height: 100%;
                    object-fit: contain;
                    drop-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
                }
                .legend {
                    position: absolute;
                    top: 5px;
                    right: 40px;
                    background: rgba(255, 255, 255, 0.95);
                    border: 1px solid #ddd;
                    border-radius: 6px;
                    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
                    backdrop-filter: blur(10px);
                    min-width: 90px;
                    max-width: 140px;
                    z-index: 1000;
                    transition: all 0.3s ease;
                    cursor: move;
                }
                .legend:hover {
                    background: rgba(255, 255, 255, 0.98);
                    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
                }
                .legend.dragging {
                    cursor: grabbing;
                    transform: scale(1.05);
                }
                .legend-header {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 8px;
                    border-bottom: 1px solid #007acc;
                    background: rgba(0, 122, 204, 0.1);
                    border-radius: 6px 6px 0 0;
                }
                .legend-title {
                    font-weight: bold;
                    font-size: 10px;
                    color: #333;
                    display: flex;
                    align-items: center;
                    gap: 3px;
                    margin: 0;
                }
                .legend-toggle {
                    background: none;
                    border: none;
                    cursor: pointer;
                    font-size: 12px;
                    padding: 0;
                    width: 16px;
                    height: 16px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    border-radius: 2px;
                    transition: background-color 0.2s;
                }
                .legend-toggle:hover {
                    background-color: rgba(0, 122, 204, 0.2);
                }
                .legend-content {
                    padding: 8px;
                    line-height: 1.2;
                    transition: all 0.3s ease;
                }
                .legend-content.hidden {
                    display: none;
                }
                .legend-item {
                    display: flex;
                    align-items: center;
                    margin-bottom: 3px;
                    padding: 1px 0;
                    font-size: 9px;
                }
                .legend-item:hover {
                    background-color: rgba(0, 122, 204, 0.1);
                    border-radius: 2px;
                    padding: 1px 2px;
                }
                .legend-collapsed {
                    min-width: auto;
                    max-width: auto;
                }
                /* Toggle button */
                .legend-toggle-btn {
                    position: absolute;
                    top: 5px;
                    right: 5px;
                    background: rgba(255, 255, 255, 0.9);
                    border: 1px solid #ddd;
                    border-radius: 50%;
                    width: 24px;
                    height: 24px;
                    cursor: pointer;
                    font-size: 12px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 1001;
                    transition: all 0.2s ease;
                }
                .legend-toggle-btn:hover {
                    background: rgba(255, 255, 255, 1);
                    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
                }
                .legend.hidden {
                    display: none;
                }
                /* Responsive adjustments */
                @media (max-width: 768px) {
                    .legend {
                        min-width: 80px;
                        max-width: 120px;
                        right: 35px;
                    }
                    .legend-title {
                        font-size: 9px;
                    }
                    .legend-item {
                        font-size: 8px;
                    }
                    .svg-container {
                        padding: 10px;
                    }
                }
                @media (max-width: 480px) {
                    .legend {
                        min-width: 70px;
                        max-width: 100px;
                        right: 30px;
                    }
                    .legend-title {
                        font-size: 8px;
                    }
                    .legend-item {
                        font-size: 7px;
                    }
                }
                /* Print styles */
                @media print {
                    .legend {
                        position: static;
                        float: left;
                        margin: 10px;
                        box-shadow: none;
                        border: 1px solid #333;
                    }
                    .legend-toggle-btn {
                        display: none;
                    }
                    .diagram-container {
                        height: auto;
                        page-break-inside: avoid;
                    }
                }
            </style>
        </head>
        <body>
            <div class="diagram-container">
                <div class="svg-container">
                    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: ThreatModel Pages: 1 -->
<svg width="2873pt" height="863pt"
 viewBox="0.00 0.00 2873.39 863.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 859)">
<title>ThreatModel</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-859 2869.39,-859 2869.39,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_Internet</title>
<path fill="#f0f0f0" stroke="black" d="M20,-8C20,-8 192.5,-8 192.5,-8 198.5,-8 204.5,-14 204.5,-20 204.5,-20 204.5,-571 204.5,-571 204.5,-577 198.5,-583 192.5,-583 192.5,-583 20,-583 20,-583 14,-583 8,-577 8,-571 8,-571 8,-20 8,-20 8,-14 14,-8 20,-8"/>
<text text-anchor="middle" x="106.25" y="-569.5" font-family="Times New Roman,serif" font-size="10.00">Internet</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_DMZ</title>
<path fill="khaki" stroke="red" stroke-width="3" stroke-dasharray="5,2" d="M327,-239C327,-239 1230.91,-239 1230.91,-239 1236.91,-239 1242.91,-245 1242.91,-251 1242.91,-251 1242.91,-340 1242.91,-340 1242.91,-346 1236.91,-352 1230.91,-352 1230.91,-352 327,-352 327,-352 321,-352 315,-346 315,-340 315,-340 315,-251 315,-251 315,-245 321,-239 327,-239"/>
<text text-anchor="middle" x="778.95" y="-334.7" font-family="Times New Roman,serif" font-size="14.00">DMZ</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_Gateway_Zone</title>
<path fill="lightyellow" stroke="red" stroke-width="3" d="M1408.16,-580C1408.16,-580 1893.71,-580 1893.71,-580 1899.71,-580 1905.71,-586 1905.71,-592 1905.71,-592 1905.71,-835 1905.71,-835 1905.71,-841 1899.71,-847 1893.71,-847 1893.71,-847 1408.16,-847 1408.16,-847 1402.16,-847 1396.16,-841 1396.16,-835 1396.16,-835 1396.16,-592 1396.16,-592 1396.16,-586 1402.16,-580 1408.16,-580"/>
<text text-anchor="middle" x="1650.93" y="-829.7" font-family="Times New Roman,serif" font-size="14.00">Gateway_Zone</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_Intranet</title>
<path fill="none" stroke="red" stroke-width="3" d="M1737.41,-279C1737.41,-279 2845.39,-279 2845.39,-279 2851.39,-279 2857.39,-285 2857.39,-291 2857.39,-291 2857.39,-560 2857.39,-560 2857.39,-566 2851.39,-572 2845.39,-572 2845.39,-572 1737.41,-572 1737.41,-572 1731.41,-572 1725.41,-566 1725.41,-560 1725.41,-560 1725.41,-291 1725.41,-291 1725.41,-285 1731.41,-279 1737.41,-279"/>
<text text-anchor="middle" x="2291.4" y="-554.7" font-family="Times New Roman,serif" font-size="14.00">Intranet</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_Command_Zone</title>
<path fill="#f0f0f0" stroke="black" d="M1771.71,-133C1771.71,-133 1912.46,-133 1912.46,-133 1918.46,-133 1924.46,-139 1924.46,-145 1924.46,-145 1924.46,-192 1924.46,-192 1924.46,-198 1918.46,-204 1912.46,-204 1912.46,-204 1771.71,-204 1771.71,-204 1765.71,-204 1759.71,-198 1759.71,-192 1759.71,-192 1759.71,-145 1759.71,-145 1759.71,-139 1765.71,-133 1771.71,-133"/>
<text text-anchor="middle" x="1842.08" y="-190.5" font-family="Times New Roman,serif" font-size="10.00">Command_Zone</text>
</g>
<!-- External Client 1 -->
<g id="node1" class="node">
<title>External Client 1</title>
<ellipse fill="none" stroke="#add8e6" cx="106.25" cy="-538" rx="90.25" ry="18"/>
<text text-anchor="middle" x="106.25" y="-532.95" font-family="Times New Roman,serif" font-size="14.00">👤 External Client 1</text>
</g>
<!-- External Firewall -->
<g id="node9" class="node">
<title>External Firewall</title>
<polygon fill="#d3d3d3" stroke="#d3d3d3" points="533.78,-283 481.09,-301 375.69,-301 323,-283 375.69,-265 481.09,-265 533.78,-283"/>
<text text-anchor="middle" x="428.39" y="-277.95" font-family="Times New Roman,serif" font-size="14.00">🔥 External Firewall</text>
</g>
<!-- External Client 1&#45;&gt;External Firewall -->
<g id="edge1" class="edge">
<title>External Client 1&#45;&gt;External Firewall</title>
<path fill="none" stroke="darkgreen" d="M183.77,-528.43C221.94,-520.61 267.08,-506.49 301,-481 360.26,-436.47 399.08,-355.36 416.62,-312.06"/>
<polygon fill="darkgreen" stroke="darkgreen" points="419.85,-313.41 420.25,-302.82 413.33,-310.85 419.85,-313.41"/>
<text text-anchor="middle" x="259.75" y="-548.06" font-family="Times New Roman,serif" font-size="7.00">test1</text>
<text text-anchor="middle" x="259.75" y="-539.06" font-family="Times New Roman,serif" font-size="7.00">Protocol: HTTPS</text>
<text text-anchor="middle" x="259.75" y="-530.06" font-family="Times New Roman,serif" font-size="7.00">Data: Web Traffic</text>
<text text-anchor="middle" x="259.75" y="-521.06" font-family="Times New Roman,serif" font-size="7.00">🔒 Encrypted</text>
</g>
<!-- External Client 2 -->
<g id="node2" class="node">
<title>External Client 2</title>
<ellipse fill="#add8e6" stroke="#add8e6" cx="106.25" cy="-466" rx="90.25" ry="18"/>
<text text-anchor="middle" x="106.25" y="-460.95" font-family="Times New Roman,serif" font-size="14.00">👤 External Client 2</text>
</g>
<!-- External Client 2&#45;&gt;External Firewall -->
<g id="edge2" class="edge">
<title>External Client 2&#45;&gt;External Firewall</title>
<path fill="none" stroke="red" d="M178.44,-454.92C216.68,-446.78 263.53,-433.16 301,-411 345.38,-384.74 385.1,-339.1 407.7,-310.01"/>
<polygon fill="red" stroke="red" points="410.22,-312.47 413.5,-302.39 404.66,-308.23 410.22,-312.47"/>
<text text-anchor="middle" x="259.75" y="-464.87" font-family="Times New Roman,serif" font-size="7.00">test</text>
<text text-anchor="middle" x="259.75" y="-455.87" font-family="Times New Roman,serif" font-size="7.00">Protocol: HTTP</text>
<text text-anchor="middle" x="259.75" y="-446.87" font-family="Times New Roman,serif" font-size="7.00">Data: Web Traffic</text>
</g>
<!-- External Client 3 -->
<g id="node3" class="node">
<title>External Client 3</title>
<ellipse fill="#add8e6" stroke="#add8e6" cx="106.25" cy="-394" rx="90.25" ry="18"/>
<text text-anchor="middle" x="106.25" y="-388.95" font-family="Times New Roman,serif" font-size="14.00">👤 External Client 3</text>
</g>
<!-- External Client 3&#45;&gt;External Firewall -->
<g id="edge3" class="edge">
<title>External Client 3&#45;&gt;External Firewall</title>
<path fill="none" stroke="black" d="M181.39,-383.63C218.1,-377.17 262.67,-367.3 301,-353 332.6,-341.21 365.88,-322.49 390.35,-307.37"/>
<polygon fill="black" stroke="black" points="392.04,-310.44 398.65,-302.16 388.32,-304.51 392.04,-310.44"/>
<text text-anchor="middle" x="259.75" y="-395.78" font-family="Times New Roman,serif" font-size="7.00">Client 3 to External Firewall</text>
<text text-anchor="middle" x="259.75" y="-386.78" font-family="Times New Roman,serif" font-size="7.00">Protocol: FTP</text>
<text text-anchor="middle" x="259.75" y="-377.78" font-family="Times New Roman,serif" font-size="7.00">Data: File Transfer</text>
</g>
<!-- External Client 4 -->
<g id="node4" class="node">
<title>External Client 4</title>
<ellipse fill="#add8e6" stroke="#add8e6" cx="106.25" cy="-322" rx="90.25" ry="18"/>
<text text-anchor="middle" x="106.25" y="-316.95" font-family="Times New Roman,serif" font-size="14.00">👤 External Client 4</text>
</g>
<!-- External Client 4&#45;&gt;External Firewall -->
<g id="edge4" class="edge">
<title>External Client 4&#45;&gt;External Firewall</title>
<path fill="none" stroke="black" d="M184.34,-312.61C230.59,-306.97 289.61,-299.78 337.91,-293.9"/>
<polygon fill="black" stroke="black" points="338.3,-297.38 347.8,-292.7 337.45,-290.43 338.3,-297.38"/>
<text text-anchor="middle" x="259.75" y="-337.62" font-family="Times New Roman,serif" font-size="7.00">Client 4 to External Firewall</text>
<text text-anchor="middle" x="259.75" y="-328.62" font-family="Times New Roman,serif" font-size="7.00">Protocol: SFTP</text>
<text text-anchor="middle" x="259.75" y="-319.62" font-family="Times New Roman,serif" font-size="7.00">Data: File Transfer</text>
<text text-anchor="middle" x="259.75" y="-310.62" font-family="Times New Roman,serif" font-size="7.00">🔒 Encrypted</text>
</g>
<!-- External Client 5 -->
<g id="node5" class="node">
<title>External Client 5</title>
<ellipse fill="#add8e6" stroke="#add8e6" cx="106.25" cy="-250" rx="90.25" ry="18"/>
<text text-anchor="middle" x="106.25" y="-244.95" font-family="Times New Roman,serif" font-size="14.00">👤 External Client 5</text>
</g>
<!-- External Client 5&#45;&gt;External Firewall -->
<g id="edge5" class="edge">
<title>External Client 5&#45;&gt;External Firewall</title>
<path fill="none" stroke="black" d="M187.27,-241.8C222.34,-239.79 263.88,-239.54 301,-245 323,-248.24 346.49,-254.48 367.17,-260.99"/>
<polygon fill="black" stroke="black" points="365.99,-264.28 376.58,-264.04 368.15,-257.63 365.99,-264.28"/>
<text text-anchor="middle" x="259.75" y="-265.35" font-family="Times New Roman,serif" font-size="7.00">Client 5 to External Firewall</text>
<text text-anchor="middle" x="259.75" y="-256.35" font-family="Times New Roman,serif" font-size="7.00">Protocol: DNS</text>
<text text-anchor="middle" x="259.75" y="-247.35" font-family="Times New Roman,serif" font-size="7.00">Data: DNS Query</text>
</g>
<!-- External Client 6 -->
<g id="node6" class="node">
<title>External Client 6</title>
<ellipse fill="#add8e6" stroke="#add8e6" cx="106.25" cy="-178" rx="90.25" ry="18"/>
<text text-anchor="middle" x="106.25" y="-172.95" font-family="Times New Roman,serif" font-size="14.00">👤 External Client 6</text>
</g>
<!-- External Client 6&#45;&gt;External Firewall -->
<g id="edge6" class="edge">
<title>External Client 6&#45;&gt;External Firewall</title>
<path fill="none" stroke="black" d="M194.96,-181.85C228.86,-185.37 267.47,-191.91 301,-204 335.81,-216.55 371.17,-239.73 395.61,-257.75"/>
<polygon fill="black" stroke="black" points="393.43,-260.49 403.52,-263.71 397.64,-254.9 393.43,-260.49"/>
<text text-anchor="middle" x="259.75" y="-224.35" font-family="Times New Roman,serif" font-size="7.00">Client 6 to External Firewall</text>
<text text-anchor="middle" x="259.75" y="-215.35" font-family="Times New Roman,serif" font-size="7.00">Protocol: SMTP</text>
<text text-anchor="middle" x="259.75" y="-206.35" font-family="Times New Roman,serif" font-size="7.00">Data: Mail Traffic</text>
</g>
<!-- External Client 7 -->
<g id="node7" class="node">
<title>External Client 7</title>
<ellipse fill="#add8e6" stroke="#add8e6" cx="106.25" cy="-106" rx="90.25" ry="18"/>
<text text-anchor="middle" x="106.25" y="-100.95" font-family="Times New Roman,serif" font-size="14.00">👤 External Client 7</text>
</g>
<!-- External Client 7&#45;&gt;External Firewall -->
<g id="edge7" class="edge">
<title>External Client 7&#45;&gt;External Firewall</title>
<path fill="none" stroke="black" d="M189.38,-113.26C225.42,-119.14 267.14,-129.77 301,-149 347.42,-175.36 387.04,-224.32 409,-255.2"/>
<polygon fill="black" stroke="black" points="406.04,-257.08 414.62,-263.3 411.79,-253.09 406.04,-257.08"/>
<text text-anchor="middle" x="259.75" y="-169.35" font-family="Times New Roman,serif" font-size="7.00">Client 7 to External Firewall</text>
<text text-anchor="middle" x="259.75" y="-160.35" font-family="Times New Roman,serif" font-size="7.00">Protocol: RTSP</text>
<text text-anchor="middle" x="259.75" y="-151.35" font-family="Times New Roman,serif" font-size="7.00">Data: Video Stream</text>
</g>
<!-- External Client 8 -->
<g id="node8" class="node">
<title>External Client 8</title>
<ellipse fill="#add8e6" stroke="#add8e6" cx="106.25" cy="-34" rx="90.25" ry="18"/>
<text text-anchor="middle" x="106.25" y="-28.95" font-family="Times New Roman,serif" font-size="14.00">👤 External Client 8</text>
</g>
<!-- External Client 8&#45;&gt;External Firewall -->
<g id="edge8" class="edge">
<title>External Client 8&#45;&gt;External Firewall</title>
<path fill="none" stroke="teal" stroke-dasharray="5,2" d="M189.92,-40.98C226.69,-47.41 268.84,-59.68 301,-83 361.72,-127.03 400.12,-210.01 417.15,-253.97"/>
<polygon fill="teal" stroke="teal" points="413.79,-254.96 420.58,-263.09 420.34,-252.5 413.79,-254.96"/>
<text text-anchor="middle" x="259.75" y="-103.35" font-family="Times New Roman,serif" font-size="7.00">Client 8 to External Firewall</text>
<text text-anchor="middle" x="259.75" y="-94.35" font-family="Times New Roman,serif" font-size="7.00">Protocol: MQTT</text>
<text text-anchor="middle" x="259.75" y="-85.35" font-family="Times New Roman,serif" font-size="7.00">Data: IoT Data</text>
</g>
<!-- Protocol Break Device -->
<g id="node10" class="node">
<title>Protocol Break Device</title>
<polygon fill="lightgreen" stroke="black" points="864.53,-301 701.53,-301 701.53,-265 864.53,-265 864.53,-301"/>
<text text-anchor="middle" x="783.03" y="-277.95" font-family="Times New Roman,serif" font-size="14.00">🖥️ Protocol Break Device</text>
</g>
<!-- External Firewall&#45;&gt;Protocol Break Device -->
<g id="edge9" class="edge">
<title>External Firewall&#45;&gt;Protocol Break Device</title>
<path fill="none" stroke="darkgreen" d="M535.19,-283C584.39,-283 642.36,-283 689.76,-283"/>
<polygon fill="darkgreen" stroke="darkgreen" points="689.74,-286.5 699.74,-283 689.74,-279.5 689.74,-286.5"/>
<text text-anchor="middle" x="617.66" y="-312.35" font-family="Times New Roman,serif" font-size="7.00">External Firewall to Protocol Break Device</text>
<text text-anchor="middle" x="617.66" y="-303.35" font-family="Times New Roman,serif" font-size="7.00">Protocol: HTTPS</text>
<text text-anchor="middle" x="617.66" y="-294.35" font-family="Times New Roman,serif" font-size="7.00">Data: Web Traffic</text>
<text text-anchor="middle" x="617.66" y="-285.35" font-family="Times New Roman,serif" font-size="7.00">🔒 Encrypted</text>
</g>
<!-- Internal Firewall -->
<g id="node11" class="node">
<title>Internal Firewall</title>
<polygon fill="#d3d3d3" stroke="#d3d3d3" points="1234.91,-283 1183.69,-301 1081.25,-301 1030.03,-283 1081.25,-265 1183.69,-265 1234.91,-283"/>
<text text-anchor="middle" x="1132.47" y="-277.95" font-family="Times New Roman,serif" font-size="14.00">🔥 Internal Firewall</text>
</g>
<!-- Protocol Break Device&#45;&gt;Internal Firewall -->
<g id="edge10" class="edge">
<title>Protocol Break Device&#45;&gt;Internal Firewall</title>
<path fill="none" stroke="darkgreen" d="M864.61,-283C909.9,-283 967.17,-283 1017.04,-283"/>
<polygon fill="darkgreen" stroke="darkgreen" points="1017.04,-286.5 1027.04,-283 1017.04,-279.5 1017.04,-286.5"/>
<text text-anchor="middle" x="947.28" y="-312.35" font-family="Times New Roman,serif" font-size="7.00">Protocol Break Device to Internal Firewall</text>
<text text-anchor="middle" x="947.28" y="-303.35" font-family="Times New Roman,serif" font-size="7.00">Protocol: HTTPS</text>
<text text-anchor="middle" x="947.28" y="-294.35" font-family="Times New Roman,serif" font-size="7.00">Data: Web Traffic</text>
<text text-anchor="middle" x="947.28" y="-285.35" font-family="Times New Roman,serif" font-size="7.00">🔒 Encrypted</text>
</g>
<!-- Gateway Load Balancer -->
<g id="node12" class="node">
<title>Gateway Load Balancer</title>
<polygon fill="gold" stroke="gold" points="1574.66,-680 1404.16,-680 1404.16,-644 1574.66,-644 1574.66,-680"/>
<text text-anchor="middle" x="1489.41" y="-656.95" font-family="Times New Roman,serif" font-size="14.00">🖥️ Gateway Load Balancer</text>
</g>
<!-- Internal Firewall&#45;&gt;Gateway Load Balancer -->
<g id="edge11" class="edge">
<title>Internal Firewall&#45;&gt;Gateway Load Balancer</title>
<path fill="none" stroke="darkgreen" d="M1150.59,-301.28C1208.34,-362.95 1396.15,-563.48 1463.82,-635.75"/>
<polygon fill="darkgreen" stroke="darkgreen" points="1461.03,-637.89 1470.42,-642.8 1466.14,-633.11 1461.03,-637.89"/>
<text text-anchor="middle" x="1319.53" y="-568.76" font-family="Times New Roman,serif" font-size="7.00">Internal Firewall to Gateway Load Balancer</text>
<text text-anchor="middle" x="1319.53" y="-559.76" font-family="Times New Roman,serif" font-size="7.00">Protocol: HTTPS</text>
<text text-anchor="middle" x="1319.53" y="-550.76" font-family="Times New Roman,serif" font-size="7.00">Data: Web Traffic</text>
<text text-anchor="middle" x="1319.53" y="-541.76" font-family="Times New Roman,serif" font-size="7.00">🔒 Encrypted</text>
</g>
<!-- Switch -->
<g id="node19" class="node">
<title>Switch</title>
<polygon fill="#e6e6fa" stroke="#e6e6fa" points="2161.82,-380 2087.76,-362 2161.82,-344 2235.89,-362 2161.82,-380"/>
<text text-anchor="middle" x="2161.82" y="-356.95" font-family="Times New Roman,serif" font-size="14.00">🔀 Switch</text>
</g>
<!-- Internal Firewall&#45;&gt;Switch -->
<g id="edge18" class="edge">
<title>Internal Firewall&#45;&gt;Switch</title>
<path fill="none" stroke="black" d="M1207.91,-273.03C1352.29,-255.62 1680,-225.42 1950.76,-269 2003.9,-277.55 2016.64,-284.96 2065.76,-307 2088.51,-317.21 2112.82,-331.34 2131.17,-342.72"/>
<polygon fill="black" stroke="black" points="2129.09,-345.55 2139.42,-347.92 2132.82,-339.63 2129.09,-345.55"/>
<text text-anchor="middle" x="1654.03" y="-268.06" font-family="Times New Roman,serif" font-size="7.00">Internal Firewall to Switch</text>
<text text-anchor="middle" x="1654.03" y="-259.06" font-family="Times New Roman,serif" font-size="7.00">Protocol: Ethernet</text>
<text text-anchor="middle" x="1654.03" y="-250.06" font-family="Times New Roman,serif" font-size="7.00">Data: General Traffic</text>
</g>
<!-- App Server 1 -->
<g id="node13" class="node">
<title>App Server 1</title>
<polygon fill="#b0e0e6" stroke="#b0e0e6" points="1897.71,-633 1786.46,-633 1786.46,-597 1897.71,-597 1897.71,-633"/>
<text text-anchor="middle" x="1842.08" y="-609.95" font-family="Times New Roman,serif" font-size="14.00">🖥️ App Server 1</text>
</g>
<!-- Gateway Load Balancer&#45;&gt;App Server 1 -->
<g id="edge12" class="edge">
<title>Gateway Load Balancer&#45;&gt;App Server 1</title>
<path fill="none" stroke="darkgreen" d="M1537.3,-643.54C1555.54,-637.16 1576.8,-630.69 1596.66,-627 1656.21,-615.94 1725.24,-613.48 1774.72,-613.47"/>
<polygon fill="darkgreen" stroke="darkgreen" points="1774.7,-616.97 1784.72,-613.5 1774.73,-609.97 1774.7,-616.97"/>
<text text-anchor="middle" x="1654.03" y="-656.35" font-family="Times New Roman,serif" font-size="7.00">Gateway Load Balancer to App Server 1</text>
<text text-anchor="middle" x="1654.03" y="-647.35" font-family="Times New Roman,serif" font-size="7.00">Protocol: HTTPS</text>
<text text-anchor="middle" x="1654.03" y="-638.35" font-family="Times New Roman,serif" font-size="7.00">Data: API Request</text>
<text text-anchor="middle" x="1654.03" y="-629.35" font-family="Times New Roman,serif" font-size="7.00">🔒 Encrypted</text>
</g>
<!-- App Server 2 -->
<g id="node14" class="node">
<title>App Server 2</title>
<polygon fill="#b0e0e6" stroke="#b0e0e6" points="1897.71,-790 1786.46,-790 1786.46,-754 1897.71,-754 1897.71,-790"/>
<text text-anchor="middle" x="1842.08" y="-766.95" font-family="Times New Roman,serif" font-size="14.00">🖥️ App Server 2</text>
</g>
<!-- Gateway Load Balancer&#45;&gt;App Server 2 -->
<g id="edge13" class="edge">
<title>Gateway Load Balancer&#45;&gt;App Server 2</title>
<path fill="none" stroke="darkgreen" d="M1514.39,-680.24C1535.09,-695.08 1566.36,-715.41 1596.66,-727 1654.6,-749.18 1724.57,-760.64 1774.77,-766.43"/>
<polygon fill="darkgreen" stroke="darkgreen" points="1774.3,-769.9 1784.63,-767.51 1775.07,-762.94 1774.3,-769.9"/>
<text text-anchor="middle" x="1654.03" y="-785.96" font-family="Times New Roman,serif" font-size="7.00">Gateway Load Balancer to App Server 2</text>
<text text-anchor="middle" x="1654.03" y="-776.96" font-family="Times New Roman,serif" font-size="7.00">Protocol: HTTPS</text>
<text text-anchor="middle" x="1654.03" y="-767.96" font-family="Times New Roman,serif" font-size="7.00">Data: API Request</text>
<text text-anchor="middle" x="1654.03" y="-758.96" font-family="Times New Roman,serif" font-size="7.00">🔒 Encrypted</text>
</g>
<!-- App Server 3 -->
<g id="node15" class="node">
<title>App Server 3</title>
<polygon fill="#b0e0e6" stroke="#b0e0e6" points="1897.71,-712 1786.46,-712 1786.46,-676 1897.71,-676 1897.71,-712"/>
<text text-anchor="middle" x="1842.08" y="-688.95" font-family="Times New Roman,serif" font-size="14.00">🖥️ App Server 3</text>
</g>
<!-- Gateway Load Balancer&#45;&gt;App Server 3 -->
<g id="edge14" class="edge">
<title>Gateway Load Balancer&#45;&gt;App Server 3</title>
<path fill="none" stroke="darkgreen" d="M1574.85,-669.71C1636.18,-675.3 1718.03,-682.77 1774.71,-687.94"/>
<polygon fill="darkgreen" stroke="darkgreen" points="1774.27,-691.42 1784.55,-688.84 1774.91,-684.45 1774.27,-691.42"/>
<text text-anchor="middle" x="1654.03" y="-711.16" font-family="Times New Roman,serif" font-size="7.00">Gateway Load Balancer to App Server 3</text>
<text text-anchor="middle" x="1654.03" y="-702.16" font-family="Times New Roman,serif" font-size="7.00">Protocol: HTTPS</text>
<text text-anchor="middle" x="1654.03" y="-693.16" font-family="Times New Roman,serif" font-size="7.00">Data: API Request</text>
<text text-anchor="middle" x="1654.03" y="-684.16" font-family="Times New Roman,serif" font-size="7.00">🔒 Encrypted</text>
</g>
<!-- App Server 1&#45;&gt;Switch -->
<g id="edge15" class="edge">
<title>App Server 1&#45;&gt;Switch</title>
<path fill="none" stroke="black" d="M1898.11,-603.12C1915.7,-597.91 1934.75,-590.72 1950.76,-581 2012.54,-543.49 2026.68,-526.81 2065.76,-466 2080.88,-442.46 2069.99,-428.62 2087.76,-407 2097.31,-395.37 2110.7,-385.92 2123.41,-378.73"/>
<polygon fill="black" stroke="black" points="2124.83,-381.93 2132.03,-374.16 2121.56,-375.75 2124.83,-381.93"/>
<text text-anchor="middle" x="2019.26" y="-586.64" font-family="Times New Roman,serif" font-size="7.00">App Server 1 to Switch</text>
<text text-anchor="middle" x="2019.26" y="-577.64" font-family="Times New Roman,serif" font-size="7.00">Protocol: Ethernet</text>
<text text-anchor="middle" x="2019.26" y="-568.64" font-family="Times New Roman,serif" font-size="7.00">Data: General Traffic</text>
</g>
<!-- App Server 2&#45;&gt;Switch -->
<g id="edge16" class="edge">
<title>App Server 2&#45;&gt;Switch</title>
<path fill="none" stroke="black" d="M1898.03,-770.91C1950.04,-766.66 2025.9,-751.47 2065.76,-701 2106.36,-649.58 2053.69,-462.97 2087.76,-407 2095.39,-394.45 2107.99,-384.89 2120.6,-377.88"/>
<polygon fill="black" stroke="black" points="2121.93,-381.13 2129.26,-373.48 2118.76,-374.89 2121.93,-381.13"/>
<text text-anchor="middle" x="2019.26" y="-776.61" font-family="Times New Roman,serif" font-size="7.00">App Server 2 to Switch</text>
<text text-anchor="middle" x="2019.26" y="-767.61" font-family="Times New Roman,serif" font-size="7.00">Protocol: Ethernet</text>
<text text-anchor="middle" x="2019.26" y="-758.61" font-family="Times New Roman,serif" font-size="7.00">Data: General Traffic</text>
</g>
<!-- App Server 3&#45;&gt;Switch -->
<g id="edge17" class="edge">
<title>App Server 3&#45;&gt;Switch</title>
<path fill="none" stroke="black" d="M1898.14,-687.27C1950.23,-677.77 2026.15,-655.17 2065.76,-602 2117.85,-532.05 2041.02,-480.64 2087.76,-407 2095.63,-394.59 2108.28,-385.07 2120.86,-378.04"/>
<polygon fill="black" stroke="black" points="2122.19,-381.3 2129.5,-373.63 2119,-375.06 2122.19,-381.3"/>
<text text-anchor="middle" x="2019.26" y="-685.18" font-family="Times New Roman,serif" font-size="7.00">App Server 3 to Switch</text>
<text text-anchor="middle" x="2019.26" y="-676.18" font-family="Times New Roman,serif" font-size="7.00">Protocol: Ethernet</text>
<text text-anchor="middle" x="2019.26" y="-667.18" font-family="Times New Roman,serif" font-size="7.00">Data: General Traffic</text>
</g>
<!-- Internal Operator 1 -->
<g id="node16" class="node">
<title>Internal Operator 1</title>
<ellipse fill="forestgreen" stroke="forestgreen" cx="1842.08" cy="-305" rx="97.93" ry="18"/>
<text text-anchor="middle" x="1842.08" y="-299.95" font-family="Times New Roman,serif" font-size="14.00">👤 Internal Operator 1</text>
</g>
<!-- Internal Operator 1&#45;&gt;Switch -->
<g id="edge20" class="edge">
<title>Internal Operator 1&#45;&gt;Switch</title>
<path fill="none" stroke="black" d="M1933.95,-311.49C1974.59,-315.44 2022.89,-321.61 2065.76,-331 2084.26,-335.05 2104.26,-341.28 2121.11,-347.1"/>
<polygon fill="black" stroke="black" points="2119.67,-350.3 2130.27,-350.33 2122,-343.7 2119.67,-350.3"/>
<text text-anchor="middle" x="2019.26" y="-351.35" font-family="Times New Roman,serif" font-size="7.00">Internal Operator 1 to Switch</text>
<text text-anchor="middle" x="2019.26" y="-342.35" font-family="Times New Roman,serif" font-size="7.00">Protocol: Ethernet</text>
<text text-anchor="middle" x="2019.26" y="-333.35" font-family="Times New Roman,serif" font-size="7.00">Data: General Traffic</text>
</g>
<!-- Internal Operator 2 -->
<g id="node17" class="node">
<title>Internal Operator 2</title>
<ellipse fill="forestgreen" stroke="forestgreen" cx="1842.08" cy="-377" rx="97.93" ry="18"/>
<text text-anchor="middle" x="1842.08" y="-371.95" font-family="Times New Roman,serif" font-size="14.00">👤 Internal Operator 2</text>
</g>
<!-- Internal Operator 2&#45;&gt;Switch -->
<g id="edge21" class="edge">
<title>Internal Operator 2&#45;&gt;Switch</title>
<path fill="none" stroke="black" d="M1937.55,-372.54C1985.35,-370.28 2042.5,-367.59 2087.02,-365.48"/>
<polygon fill="black" stroke="black" points="2087,-368.99 2096.83,-365.02 2086.67,-362 2087,-368.99"/>
<text text-anchor="middle" x="2019.26" y="-391.19" font-family="Times New Roman,serif" font-size="7.00">Internal Operator 2 to Switch</text>
<text text-anchor="middle" x="2019.26" y="-382.19" font-family="Times New Roman,serif" font-size="7.00">Protocol: Ethernet</text>
<text text-anchor="middle" x="2019.26" y="-373.19" font-family="Times New Roman,serif" font-size="7.00">Data: General Traffic</text>
</g>
<!-- System Administrator -->
<g id="node18" class="node">
<title>System Administrator</title>
<ellipse fill="forestgreen" stroke="forestgreen" cx="1842.08" cy="-449" rx="108.67" ry="18"/>
<text text-anchor="middle" x="1842.08" y="-443.95" font-family="Times New Roman,serif" font-size="14.00">👤 System Administrator</text>
</g>
<!-- System Administrator&#45;&gt;Switch -->
<g id="edge22" class="edge">
<title>System Administrator&#45;&gt;Switch</title>
<path fill="none" stroke="black" d="M1929.49,-437.97C1971.28,-431.31 2021.79,-421.29 2065.76,-407 2087.39,-399.97 2110.47,-389.13 2128.48,-379.85"/>
<polygon fill="black" stroke="black" points="2129.88,-383.06 2137.1,-375.31 2126.63,-376.87 2129.88,-383.06"/>
<text text-anchor="middle" x="2019.26" y="-450.15" font-family="Times New Roman,serif" font-size="7.00">System Administrator to Switch</text>
<text text-anchor="middle" x="2019.26" y="-441.15" font-family="Times New Roman,serif" font-size="7.00">Protocol: Ethernet</text>
<text text-anchor="middle" x="2019.26" y="-432.15" font-family="Times New Roman,serif" font-size="7.00">Data: General Traffic</text>
</g>
<!-- Central Server -->
<g id="node20" class="node">
<title>Central Server</title>
<polygon fill="#98fb98" stroke="#98fb98" points="2534.39,-457 2416.39,-457 2416.39,-421 2534.39,-421 2534.39,-457"/>
<text text-anchor="middle" x="2475.39" y="-433.95" font-family="Times New Roman,serif" font-size="14.00">🖥️ Central Server</text>
</g>
<!-- System Administrator&#45;&gt;Central Server -->
<g id="edge24" class="edge">
<title>System Administrator&#45;&gt;Central Server</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1923.85,-461.24C1940.01,-463.22 1956.89,-464.96 1972.76,-466 2014,-468.69 2024.44,-467.19 2065.76,-466 2138.88,-463.89 2321.47,-452.75 2394.39,-447 2397.83,-446.73 2401.35,-446.44 2404.9,-446.13"/>
<polygon fill="blue" stroke="blue" points="2405.15,-449.62 2414.8,-445.23 2404.52,-442.65 2405.15,-449.62"/>
<text text-anchor="middle" x="2161.82" y="-503.46" font-family="Times New Roman,serif" font-size="7.00">System Administrator to Central Server</text>
<text text-anchor="middle" x="2161.82" y="-494.46" font-family="Times New Roman,serif" font-size="7.00">Protocol: SSH</text>
<text text-anchor="middle" x="2161.82" y="-485.46" font-family="Times New Roman,serif" font-size="7.00">Data: SSH Traffic</text>
<text text-anchor="middle" x="2161.82" y="-476.46" font-family="Times New Roman,serif" font-size="7.00">🔐 Authenticated</text>
<text text-anchor="middle" x="2161.82" y="-467.46" font-family="Times New Roman,serif" font-size="7.00">🔒 Encrypted</text>
</g>
<!-- Authentication Server -->
<g id="node22" class="node">
<title>Authentication Server</title>
<polygon fill="lightgreen" stroke="black" points="2849.39,-485 2691.64,-485 2691.64,-449 2849.39,-449 2849.39,-485"/>
<text text-anchor="middle" x="2770.52" y="-461.95" font-family="Times New Roman,serif" font-size="14.00">🖥️ Authentication Server</text>
</g>
<!-- System Administrator&#45;&gt;Authentication Server -->
<g id="edge25" class="edge">
<title>System Administrator&#45;&gt;Authentication Server</title>
<path fill="none" stroke="teal" d="M1893.72,-465.29C1953.74,-484.28 2050.35,-513.75 2087.76,-519 2227.94,-538.66 2578.23,-502.16 2669.64,-489 2673.05,-488.51 2676.51,-487.97 2680,-487.39"/>
<polygon fill="teal" stroke="teal" points="2680.49,-490.85 2689.72,-485.66 2679.26,-483.96 2680.49,-490.85"/>
<text text-anchor="middle" x="2326.14" y="-562.03" font-family="Times New Roman,serif" font-size="7.00">System Administrator to Authentication Server</text>
<text text-anchor="middle" x="2326.14" y="-553.03" font-family="Times New Roman,serif" font-size="7.00">Protocol: LDAPS</text>
<text text-anchor="middle" x="2326.14" y="-544.03" font-family="Times New Roman,serif" font-size="7.00">Data: Authentication Request</text>
<text text-anchor="middle" x="2326.14" y="-535.03" font-family="Times New Roman,serif" font-size="7.00">🔐 Authenticated</text>
<text text-anchor="middle" x="2326.14" y="-526.03" font-family="Times New Roman,serif" font-size="7.00">🔒 Encrypted</text>
</g>
<!-- Switch&#45;&gt;Central Server -->
<g id="edge23" class="edge">
<title>Switch&#45;&gt;Central Server</title>
<path fill="none" stroke="darkgreen" d="M2248.61,-362.4C2293.18,-364.89 2347.9,-371.57 2394.39,-388 2411.43,-394.02 2428.55,-404.24 2442.56,-413.96"/>
<polygon fill="darkgreen" stroke="darkgreen" points="2248.89,-358.91 2238.73,-361.92 2248.55,-365.9 2248.89,-358.91"/>
<polygon fill="darkgreen" stroke="darkgreen" points="2440.33,-416.67 2450.49,-419.67 2444.42,-410.99 2440.33,-416.67"/>
<text text-anchor="middle" x="2326.14" y="-435.35" font-family="Times New Roman,serif" font-size="7.00">Switch to Central Server</text>
<text text-anchor="middle" x="2326.14" y="-426.35" font-family="Times New Roman,serif" font-size="7.00">Protocol: HTTPS</text>
<text text-anchor="middle" x="2326.14" y="-417.35" font-family="Times New Roman,serif" font-size="7.00">Data: Server Request</text>
<text text-anchor="middle" x="2326.14" y="-408.35" font-family="Times New Roman,serif" font-size="7.00">🔐 Authenticated</text>
<text text-anchor="middle" x="2326.14" y="-399.35" font-family="Times New Roman,serif" font-size="7.00">🔒 Encrypted</text>
<text text-anchor="middle" x="2326.14" y="-390.35" font-family="Times New Roman,serif" font-size="7.00">↔️ Bidirectional</text>
</g>
<!-- Central Server&#45;&gt;Authentication Server -->
<g id="edge26" class="edge">
<title>Central Server&#45;&gt;Authentication Server</title>
<path fill="none" stroke="teal" d="M2534.6,-434.88C2573.11,-433.17 2624.61,-432.81 2669.64,-439 2680.62,-440.51 2692.08,-442.91 2703.17,-445.68"/>
<polygon fill="teal" stroke="teal" points="2702.07,-449.01 2712.63,-448.18 2703.85,-442.25 2702.07,-449.01"/>
<text text-anchor="middle" x="2613.02" y="-477.35" font-family="Times New Roman,serif" font-size="7.00">Central Server to Authentication Server</text>
<text text-anchor="middle" x="2613.02" y="-468.35" font-family="Times New Roman,serif" font-size="7.00">Protocol: LDAPS</text>
<text text-anchor="middle" x="2613.02" y="-459.35" font-family="Times New Roman,serif" font-size="7.00">Data: Authentication Request</text>
<text text-anchor="middle" x="2613.02" y="-450.35" font-family="Times New Roman,serif" font-size="7.00">🔐 Authenticated</text>
<text text-anchor="middle" x="2613.02" y="-441.35" font-family="Times New Roman,serif" font-size="7.00">🔒 Encrypted</text>
</g>
<!-- Application Database -->
<g id="node21" class="node">
<title>Application Database</title>
<path fill="#ffdab9" stroke="#ffdab9" d="M1919.83,-535.73C1919.83,-537.53 1884.98,-539 1842.08,-539 1799.18,-539 1764.33,-537.53 1764.33,-535.73 1764.33,-535.73 1764.33,-506.27 1764.33,-506.27 1764.33,-504.47 1799.18,-503 1842.08,-503 1884.98,-503 1919.83,-504.47 1919.83,-506.27 1919.83,-506.27 1919.83,-535.73 1919.83,-535.73"/>
<path fill="none" stroke="#ffdab9" d="M1919.83,-535.73C1919.83,-533.92 1884.98,-532.45 1842.08,-532.45 1799.18,-532.45 1764.33,-533.92 1764.33,-535.73"/>
<text text-anchor="middle" x="1842.08" y="-515.95" font-family="Times New Roman,serif" font-size="14.00">🗄️ Application Database</text>
</g>
<!-- Command Machine -->
<g id="node23" class="node">
<title>Command Machine</title>
<polygon fill="lightgreen" stroke="black" points="1916.46,-177 1767.71,-177 1767.71,-141 1916.46,-141 1916.46,-177"/>
<text text-anchor="middle" x="1842.08" y="-153.95" font-family="Times New Roman,serif" font-size="14.00">🖥️ Command Machine</text>
</g>
<!-- Command Machine&#45;&gt;Switch -->
<g id="edge19" class="edge">
<title>Command Machine&#45;&gt;Switch</title>
<path fill="none" stroke="black" d="M1916.88,-147.73C1963.32,-144.56 2022.44,-148.1 2065.76,-177 2120.28,-213.38 2145.28,-291.17 2155.21,-333.36"/>
<polygon fill="black" stroke="black" points="2151.77,-334.02 2157.35,-343.02 2158.6,-332.5 2151.77,-334.02"/>
<text text-anchor="middle" x="2019.26" y="-197.35" font-family="Times New Roman,serif" font-size="7.00">Command Machine to Switch</text>
<text text-anchor="middle" x="2019.26" y="-188.35" font-family="Times New Roman,serif" font-size="7.00">Protocol: Ethernet</text>
<text text-anchor="middle" x="2019.26" y="-179.35" font-family="Times New Roman,serif" font-size="7.00">Data: General Traffic</text>
</g>
</g>
</svg>

                </div>
                
                <!-- Toggle button for legend -->
                <button class="legend-toggle-btn" onclick="toggleLegend()" title="Masquer/Afficher la légende">
                    👁️
                </button>
                
                <div class="legend" id="legend">
                    <div class="legend-header">
                        <div class="legend-title">
                            🔍 Légende
                        </div>
                        <button class="legend-toggle" onclick="toggleLegendContent()" title="Réduire/Étendre">
                            <span id="toggle-icon">−</span>
                        </button>
                    </div>
                    <div class="legend-content" id="legend-content">
                        
                <div style="display: flex; align-items: center; margin-bottom: 3px;">
                    <div style="width: 12px; height: 8px; background-color: #FFFF99; 
                            border: 1px solid #999; margin-right: 8px; border-radius: 2px;"></div>
                    <span style="font-size: 9px;">👤 Acteur</span>
                </div>
            
                <div style="display: flex; align-items: center; margin-bottom: 3px;">
                    <div style="width: 12px; height: 8px; background-color: #90EE90; 
                            border: 1px solid #999; margin-right: 8px; border-radius: 2px;"></div>
                    <span style="font-size: 9px;">🖥️ Serveur</span>
                </div>
            
                <div style="display: flex; align-items: center; margin-bottom: 3px;">
                    <div style="width: 12px; height: 8px; background-color: #ADD8E6; 
                            border: 1px solid #999; margin-right: 8px; border-radius: 2px;"></div>
                    <span style="font-size: 9px;">🗄️ Database</span>
                </div>
            
                <div style="display: flex; align-items: center; margin-bottom: 3px;">
                    <div style="width: 12px; height: 8px; background-color: #FF6B6B; 
                            border: 1px solid #999; margin-right: 8px; border-radius: 2px;"></div>
                    <span style="font-size: 9px;">🔥 Firewall</span>
                </div>
            
                <div style="display: flex; align-items: center; margin-bottom: 3px;">
                    <div style="width: 20px; height: 15px; border: 3px solid #FF0000; 
                            margin-right: 8px; border-radius: 2px;"></div>
                    <span style="font-size: 11px;">Trust Boundaries</span>
                </div>
            
                <div style="display: flex; align-items: center; margin-bottom: 3px;">
                    <div style="width: 20px; height: 15px; border: 1px solid #000000; 
                            margin-right: 8px; border-radius: 2px;"></div>
                    <span style="font-size: 11px;">Untrust Boundaries</span>
                </div>
            <div style="margin-top: 5px; margin-bottom: 3px; font-weight: bold; font-size: 10px;">Protocoles:</div>
                    <div style="display: flex; align-items: center; margin-bottom: 3px;">
                        <div style="width: 20px; height: 2px; background-color: darkgreen; 
                                margin-right: 8px;"></div>
                        <span style="font-size: 11px;">HTTPS</span>
                    </div>
                
                    <div style="display: flex; align-items: center; margin-bottom: 3px;">
                        <div style="width: 20px; height: 2px; background-color: red; 
                                margin-right: 8px;"></div>
                        <span style="font-size: 11px;">HTTP</span>
                    </div>
                
                    <div style="display: flex; align-items: center; margin-bottom: 3px;">
                        <div style="width: 20px; height: 2px; background-color: blue; 
                                margin-right: 8px;"></div>
                        <span style="font-size: 11px;">SSH</span>
                    </div>
                
                    <div style="display: flex; align-items: center; margin-bottom: 3px;">
                        <div style="width: 20px; height: 2px; background-color: purple; 
                                margin-right: 8px;"></div>
                        <span style="font-size: 11px;">SQL</span>
                    </div>
                
                    <div style="display: flex; align-items: center; margin-bottom: 3px;">
                        <div style="width: 20px; height: 2px; background-color: teal; 
                                margin-right: 8px;"></div>
                        <span style="font-size: 11px;">LDAPS</span>
                    </div>
                
                    <div style="display: flex; align-items: center; margin-bottom: 3px;">
                        <div style="width: 20px; height: 2px; background-color: teal; 
                                margin-right: 8px;"></div>
                        <span style="font-size: 11px;">MQTT</span>
                    </div>
                
                    </div>
                </div>
            </div>

            <script>
                // Variables pour le drag & drop
                let isDragging = false;
                let currentX;
                let currentY;
                let initialX;
                let initialY;
                let xOffset = 0;
                let yOffset = 0;
                
                const legend = document.getElementById('legend');
                
                // Event listeners pour le drag & drop
                legend.addEventListener('mousedown', dragStart);
                document.addEventListener('mousemove', drag);
                document.addEventListener('mouseup', dragEnd);
                
                // Touch events pour mobile
                legend.addEventListener('touchstart', dragStart);
                document.addEventListener('touchmove', drag);
                document.addEventListener('touchend', dragEnd);
                
                function dragStart(e) {
                    if (e.target.closest('.legend-toggle') || e.target.closest('.legend-toggle-btn')) {
                        return;
                    }
                    
                    if (e.type === "touchstart") {
                        initialX = e.touches[0].clientX - xOffset;
                        initialY = e.touches[0].clientY - yOffset;
                    } else {
                        initialX = e.clientX - xOffset;
                        initialY = e.clientY - yOffset;
                    }
                    
                    if (e.target === legend || legend.contains(e.target)) {
                        isDragging = true;
                        legend.classList.add('dragging');
                    }
                }
                
                function drag(e) {
                    if (isDragging) {
                        e.preventDefault();
                        
                        if (e.type === "touchmove") {
                            currentX = e.touches[0].clientX - initialX;
                            currentY = e.touches[0].clientY - initialY;
                        } else {
                            currentX = e.clientX - initialX;
                            currentY = e.clientY - initialY;
                        }
                        
                        xOffset = currentX;
                        yOffset = currentY;
                        
                        // Contraindre la position dans la fenêtre
                        const rect = legend.getBoundingClientRect();
                        const maxX = window.innerWidth - rect.width;
                        const maxY = window.innerHeight - rect.height;
                        
                        xOffset = Math.max(0, Math.min(maxX, xOffset));
                        yOffset = Math.max(0, Math.min(maxY, yOffset));
                        
                        legend.style.transform = `translate(${xOffset}px, ${yOffset}px)`;
                        legend.style.position = 'fixed';
                        legend.style.bottom = 'auto';
                        legend.style.left = 'auto';
                        legend.style.top = '0';
                        legend.style.right = 'auto';
                    }
                }
                
                function dragEnd(e) {
                    initialX = currentX;
                    initialY = currentY;
                    isDragging = false;
                    legend.classList.remove('dragging');
                }
                
                // Fonction pour masquer/afficher la légende
                function toggleLegend() {
                    const legend = document.getElementById('legend');
                    const toggleBtn = document.querySelector('.legend-toggle-btn');
                    
                    if (legend.classList.contains('hidden')) {
                        legend.classList.remove('hidden');
                        toggleBtn.innerHTML = '👁️';
                        toggleBtn.title = 'Masquer la légende';
                    } else {
                        legend.classList.add('hidden');
                        toggleBtn.innerHTML = '👁️‍🗨️';
                        toggleBtn.title = 'Afficher la légende';
                    }
                }
                
                // Fonction pour réduire/étendre le contenu de la légende
                function toggleLegendContent() {
                    const content = document.getElementById('legend-content');
                    const icon = document.getElementById('toggle-icon');
                    const legend = document.getElementById('legend');
                    
                    if (content.classList.contains('hidden')) {
                        content.classList.remove('hidden');
                        icon.textContent = '−';
                        legend.classList.remove('legend-collapsed');
                    } else {
                        content.classList.add('hidden');
                        icon.textContent = '+';
                        legend.classList.add('legend-collapsed');
                    }
                }
                
                // Empêcher la sélection de texte pendant le drag
                document.addEventListener('selectstart', function(e) {
                    if (isDragging) {
                        e.preventDefault();
                    }
                });
            </script>
        </body>
        </html>