digraph ThreatModel {
  rankdir=LR;
  node [shape=box, style=filled, fillcolor=lightblue];
  edge [fontsize=10];
  charset="UTF-8";
  subgraph cluster_Internet {
    label="Internet";
    style=filled;
    fillcolor="lightcoral";
    color=black;
    "External Client 1" [shape=oval, fillcolor=yellow];
    "External Client 2" [shape=oval, fillcolor=yellow];
    "External Client 3" [shape=oval, fillcolor=yellow];
    "External Client 4" [shape=oval, fillcolor=yellow];
    "External Client 5" [shape=oval, fillcolor=yellow];
    "External Client 6" [shape=oval, fillcolor=yellow];
    "External Client 7" [shape=oval, fillcolor=yellow];
    "External Client 8" [shape=oval, fillcolor=yellow];
  }
  subgraph cluster_DMZ {
    label="DMZ";
    style=filled;
    fillcolor="khaki";
    color=black;
    "External Firewall" [shape=box, fillcolor=lightgreen];
    "Protocol Break Device" [shape=box, fillcolor=lightgreen];
    "Internal Firewall" [shape=box, fillcolor=lightgreen];
  }
  subgraph cluster_Intranet {
    label="Intranet";
    style=filled;
    fillcolor="lightgreen";
    color=black;
    "Internal Operator 1" [shape=oval, fillcolor=yellow];
    "Internal Operator 2" [shape=oval, fillcolor=yellow];
    "System Administrator" [shape=oval, fillcolor=yellow];
    "Switch" [shape=box, fillcolor=lightgreen];
    "Central Server" [shape=box, fillcolor=lightgreen];
    "Application Database" [shape=box, fillcolor=lightgreen];
    "Authentication Server" [shape=box, fillcolor=lightgreen];
  }
  subgraph cluster_Command_Zone {
    label="Command_Zone";
    style=filled;
    fillcolor="lightsteelblue";
    color=black;
    "Command Machine" [shape=box, fillcolor=lightgreen];
  }
  "External Client 1" -> "External Firewall" [label="Client 1 to External Firewall\nProtocol: HTTPS\nData: Web Traffic"];
  "External Client 2" -> "External Firewall" [label="Client 2 to External Firewall\nProtocol: HTTP\nData: Web Traffic"];
  "External Client 3" -> "External Firewall" [label="Client 3 to External Firewall\nProtocol: FTP\nData: File Transfer"];
  "External Client 4" -> "External Firewall" [label="Client 4 to External Firewall\nProtocol: SFTP\nData: File Transfer"];
  "External Client 5" -> "External Firewall" [label="Client 5 to External Firewall\nProtocol: DNS\nData: DNS Query"];
  "External Client 6" -> "External Firewall" [label="Client 6 to External Firewall\nProtocol: SMTP\nData: Mail Traffic"];
  "External Client 7" -> "External Firewall" [label="Client 7 to External Firewall\nProtocol: RTSP\nData: Video Stream"];
  "External Client 8" -> "External Firewall" [label="Client 8 to External Firewall\nProtocol: MQTT\nData: IoT Data"];
  "External Firewall" -> "Protocol Break Device" [label="External Firewall to Protocol Break Device\nProtocol: HTTPS\nData: Web Traffic"];
  "Protocol Break Device" -> "Internal Firewall" [label="Protocol Break Device to Internal Firewall\nProtocol: HTTPS\nData: Web Traffic"];
  "Internal Firewall" -> "Switch" [label="Internal Firewall to Switch\nProtocol: Ethernet\nData: General Traffic"];
  "Command Machine" -> "Switch" [label="Command Machine to Switch\nProtocol: Ethernet\nData: General Traffic"];
  "Internal Operator 1" -> "Switch" [label="Internal Operator 1 to Switch\nProtocol: Ethernet\nData: General Traffic"];
  "Internal Operator 2" -> "Switch" [label="Internal Operator 2 to Switch\nProtocol: Ethernet\nData: General Traffic"];
  "System Administrator" -> "Switch" [label="System Administrator to Switch\nProtocol: Ethernet\nData: General Traffic"];
  "Switch" -> "Central Server" [label="Switch to Central Server\nProtocol: HTTPS\nData: Server Request"];
  "System Administrator" -> "Central Server" [label="System Administrator to Central Server\nProtocol: SSH\nData: SSH Traffic"];
  "System Administrator" -> "Authentication Server" [label="System Administrator to Authentication Server\nProtocol: LDAPS\nData: Authentication Request"];
  "Central Server" -> "Authentication Server" [label="Central Server to Authentication Server\nProtocol: LDAPS\nData: Authentication Request"];
}